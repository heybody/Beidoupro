离线操作协议

1 离线扫描终端报文
发送：
FF FF FF FF 57 20 A0 03 00 06 09 00 2F 02 00 00
返回：
FF FF FF FF 96 AC A0 03 00 0A 88 81 1F 02 00 04 12 34 56 78 


2 请求随机数报文
发送：
FF FF FF FF 96 AC A0 03 00 0A 44 B4 2F 0D 00 04 12 34 56 78
返回：
FF FF FF FF D6 28 A0 03 00 0E B2 76 1F 0D 00 08 12 34 56 78 31 F9 D1 C0


3 离线查询数据报文
发送：
FF FF FF FF 65 53 A0 03 00 14 3F FC 2F D3 00 0E 12 34 56 78 0D 06 13 11 2C 30 12 34 56 78
返回：
FF FF FF FF 45 11 A0 03 00 16 0F 90 1F D0 00 10 12 34 56 78 0D 06 13 11 2C 30 12 34 56 78 00 00  




操作协议

1 查询状态报文
明文：
AE BE 2F 00 00 04 12 34 56 78
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
33 0A 4F 01 53 65 A4 4D B9 61
发送：
FF FF FF FF 52 63 A0 02 00 14 12 34 56 78 AB AB AB AB 00 0A 33 0A 4F 01 53 65 A4 4D B9 61
返回：
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B 58 4C 7F 01 53 74 A4 4D B9 61 E8 3E BB 8D AE CB 2C DA 87 4D 9D B4 60 01 53 61 B6 
密文：
58 4C 7F 01 53 74 A4 4D B9 61 E8 3E BB 8D AE CB 2C DA 87 4D 9D B4 60 01 53 61 B6
明文：
C5 F8 1F 00 00 15 12 34 56 78 00 78 0A 01 01 00 00 00 00 00 00 00 00 00 00 00 00


2 配置报文
明文：(T:300, W:30, CH:0x02, TP_E:0x01, TP: 450, H_E:0x01, H: 950, S_F:0x01, S: 5000)
7E 33 2F 01 00 11 12 34 56 78 01 21 1E 02 01 01 C2 01 03 B6 01 13 88
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
E3 87 4F 00 53 70 A4 4D B9 61 E9 67 AF 8E AE CA EE DB 84 FB 9C A7 E8
发送：
FF FF FF FF 34 95 A0 02 00 21 12 34 56 78 AB AB AB AB 00 17 E3 87 4F 00 53 70 A4 4D B9 61 E9 67 AF 8E AE CA EE DB 84 FB 9C A7 E8
返回：
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B B0 1A 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CB 2C DA 86 4C 5F B5 63 B7 52 72 3E 
密文：
B0 1A 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CB 2C DA 86 4C 5F B5 63 B7 52 72 3E
明文：
2D AE 1F 00 00 15 12 34 56 78 01 21 1E 02 01 00 00 00 01 01 C2 01 03 B6 01 13 88


WHY: 01 21 ->明文：(T:300, ??? 289 ???

3 操作报文
明文：(PWR:0x01, SAFE:0x00)
9E A6 2F 0C 00 06 12 34 56 78 01 00
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
03 12 4F 0D 53 67 A4 4D B9 61 E9 46
发送：
FF FF FF FF 72 21 A0 02 00 16 12 34 56 78 AB AB AB AB 00 0C 03 12 4F 0D 53 67 A4 4D B9 61 E9 46
返回：(KEY:OFF)
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B B3 6F 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DA 86 4C 5F B5 63 B7 52 72 3E     
密文：
B3 6F 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DA 86 4C 5F B5 63 B7 52 72 3E
明文：
2E DB 1F 00 00 15 12 34 56 78 01 21 1E 02 01 01 00 00 01 01 C2 01 03 B6 01 13 88
返回：(KEY:ON)
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B DC 2A 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DB 86 4C 5F B5 63 B7 52 72 3E      
密文：
DC 2A 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DB 86 4C 5F B5 63 B7 52 72 3E
明文：
41 9E 1F 00 00 15 12 34 56 78 01 21 1E 02 01 01 00 01 01 01 C2 01 03 B6 01 13 88

明文：(PWR:0x01, SAFE:0x01)
8E 87 2F 0C 00 06 12 34 56 78 01 01
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
13 33 4F 0D 53 67 A4 4D B9 61 E9 47
发送：
FF FF FF FF 72 21 A0 02 00 16 12 34 56 78 AB AB AB AB 00 0C 13 33 4F 0D 53 67 A4 4D B9 61 E9 47
返回：(KEY:OFF)
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B B3 6F 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DA 86 4C 5F B5 63 B7 52 72 3E     
密文：
B3 6F 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2C DA 86 4C 5F B5 63 B7 52 72 3E
明文：
2E DB 1F 00 00 15 12 34 56 78 01 21 1E 02 01 01 00 00 01 01 C2 01 03 B6 01 13 88
返回：(KEY:ON)
FF FF FF FF 74 11 A0 02 00 25 12 34 56 78 AB AB AB AB 00 1B 04 63 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2D DB 86 4C 5F B5 63 B7 52 72 3E       
密文：
04 63 7F 01 53 74 A4 4D B9 61 E9 67 AF 8E AE CA 2D DB 86 4C 5F B5 63 B7 52 72 3E
明文：
99 D7 1F 00 00 15 12 34 56 78 01 21 1E 02 01 01 01 01 01 01 C2 01 03 B6 01 13 88


4 写数据报文
明文：(FORM:[0D 06 13 11 2C 30 12 34 56 78], DATA:[00 11 22 33 44 55 66 77 88 99 AA BB CC DD EE FF])
E0 95 2F D0 00 20 12 34 56 78 00 1A 0D 06 13 11 2C 30 12 34 56 78 00 11 22 33 44 55 66 77 88 99 AA BB CC DD EE FF
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
7D 21 4F D1 53 41 A4 4D B9 61 E8 5C BC 8A BC DA 00 EA 95 79 CB CC 60 10 71 52 F2 2C 89 6E 60 DF 1B 37 63 16 C2 25
发送：
FF FF FF FF 36 85 A0 02 00 30 12 34 56 78 AB AB AB AB 00 26 7D 21 4F D1 53 41 A4 4D B9 61 E8 5C BC 8A BC DA 00 EA 95 79 CB CC 60 10 71 52 F2 2C 89 6E 60 DF 1B 37 63 16 C2 25


5 读数据报文
明文：(LEN:26)
F3 4A 2F D1 00 06 12 34 56 78 00 1A
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
6E FE 4F D0 53 67 A4 4D B9 61 E8 5C
发送：
FF FF FF FF 72 21 A0 02 00 16 12 34 56 78 AB AB AB AB 00 0C 6E FE 4F D0 53 67 A4 4D B9 61 E8 5C
返回：
FF FF FF FF 36 85 A0 02 00 30 12 34 56 78 AB AB AB AB 00 26 D6 C3 7F D0 53 41 A4 4D B9 61 E8 5C BC 8A BC DA 00 EA 95 79 CB CC 60 10 71 52 F2 2C 89 6E 60 DF 1B 37 63 16 C2 25       
密文：
D6 C3 7F D0 53 41 A4 4D B9 61 E8 5C BC 8A BC DA 00 EA 95 79 CB CC 60 10 71 52 F2 2C 89 6E 60 DF 1B 37 63 16 C2 25
明文：
4B 77 1F D1 00 20 12 34 56 78 00 1A 0D 06 13 11 2C 30 12 34 56 78 00 11 22 33 44 55 66 77 88 99 AA BB CC DD EE FF


6 擦除数据报文
明文：
35 2D 2F D3 00 06 12 34 56 78 00 1A
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
A8 99 4F D2 53 67 A4 4D B9 61 E8 5C
发送：
FF FF FF FF 72 21 A0 02 00 16 12 34 56 78 AB AB AB AB 00 0C A8 99 4F D2 53 67 A4 4D B9 61 E8 5C

7 请求信息报文
明文：
8F 33 2F D2 00 04 12 34 56 78
密文：(ID:0x12345678, KEY:0x87654321, RN:0xABABABAB)
12 87 4F D3 53 65 A4 4D B9 61
发送：
FF FF FF FF 52 63 A0 02 00 14 12 34 56 78 AB AB AB AB 00 0A 12 87 4F D3 53 65 A4 4D B9 61
返回：
FF FF FF FF 26 A4 A0 02 00 31 12 34 56 78 AB AB AB AB 00 27 77 53 7F D1 53 40 A4 4D B9 61 E9 4B B7 99 A2 C5 2D DB C9 6B 91 C6 EB 44 0F 4E C6 17 EF 19 E8 46 B1 8C AF CB 2C DA 87 
密文：
77 53 7F D1 53 40 A4 4D B9 61 E9 4B B7 99 A2 C5 2D DB C9 6B 91 C6 EB 44 0F 4E C6 17 EF 19 E8 46 B1 8C AF CB 2C DA 87 
明文：
EA E7 1F D0 00 21 12 34 56 78 01 0D 06 15 0D 0E 01 01 4E 26 0C 72 8B 45 5C 2F 70 6E 00 00 00 00 00 00 00 00 00 00 00

